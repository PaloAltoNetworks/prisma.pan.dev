components:
  examples: {}
  headers: {}
  parameters: {}
  requestBodies: {}
  responses: {}
  securitySchemes:
    CustomAuthorizer:
      in: header
      name: authorization
      type: apiKey
      x-amazon-apigateway-authorizer:
        authorizerResultTtlInSeconds: 0
        authorizerUri: arn:aws:apigateway:{Region}:lambda:path/2015-03-31/functions/arn:aws:lambda:{Region}:{AccountId}:function:bc-authorization-authorizer-{UniqueTag}{Alias}/invocations
        identitySource: method.request.header.authorization
        type: request
      x-amazon-apigateway-authtype: custom
  schemas:
    CacheOutputType:
      enum:
      - Result
      - Error
      - Empty
      type: string
    OS:
      enum:
      - linux
      - darwin
      - windows
      type: string
    ReportCVE:
      additionalProperties: false
      properties:
        cveId:
          type: string
        cvss:
          format: double
          nullable: true
          type: number
        description:
          nullable: true
          type: string
        link:
          nullable: true
          type: string
        packageName:
          type: string
        packageVersion:
          type: string
        publishedDate:
          type: string
        riskFactors:
          nullable: true
        severity:
          type: string
        status:
          type: string
        vector:
          nullable: true
          type: string
      required:
      - cveId
      - status
      - severity
      - packageName
      - packageVersion
      - publishedDate
      type: object
    ScanningRequestStatus:
      enum:
      - running
      - already_exist
      type: string
    TwistlockEvaluateCvesBody:
      additionalProperties: false
      properties:
        dependencies:
          items:
            properties:
              name:
                type: string
              version:
                type: string
            required:
            - version
            - name
            type: object
          type: array
        lang:
          $ref: '#/components/schemas/TwistlockSupportedPackageManagerLang'
      required:
      - lang
      - dependencies
      type: object
    TwistlockScanResultBody:
      additionalProperties: false
      properties:
        compressedResult:
          type: string
        compressionMethod:
          type: string
        id:
          type: string
      required:
      - compressedResult
      - compressionMethod
      - id
      type: object
    TwistlockScanResultResponse:
      additionalProperties: false
      properties:
        compressionMethod:
          type: string
        outputData:
          type: string
        outputType:
          $ref: '#/components/schemas/CacheOutputType'
      required:
      - outputType
      type: object
    TwistlockScanningBody:
      additionalProperties: false
      properties:
        compressedFileBody:
          type: string
        compressionMethod:
          type: string
        fileName:
          type: string
      required:
      - compressedFileBody
      - compressionMethod
      - fileName
      type: object
    TwistlockScanningResponse:
      additionalProperties: false
      properties:
        id:
          type: string
        outputData:
          type: string
        status:
          $ref: '#/components/schemas/ScanningRequestStatus'
      required:
      - id
      - status
      type: object
    TwistlockSupportedPackageManagerLang:
      enum:
      - nodejs
      - gem
      - python
      - jar
      - nuget
      - go
      - os
      type: string
info:
  contact: {}
  description: 'The Twistlock endpoints are listed below.

    '
  title: Prisma Cloud Twistlock API Overview
  version: Latest
openapi: 3.0.0
paths:
  /code/api/v1/vulnerabilities/scan:
    post:
      operationId: performTwistlockScanning
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TwistlockScanningBody'
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TwistlockScanningResponse'
          description: Scan results are ready
        '422':
          description: Request arguments validation error
      security:
      - CustomAuthorizer: []
      summary: Perform Twistlock scanning
      tags:
      - Twistlock
      x-bc-docs-scope: standalone,prisma
      x-bc-lambda-name: bc-vulnerabilities-twistlock-api
      x-bc-permitted-roles: owner,admin,member,developer,auditor
  /code/api/v1/vulnerabilities/scan-results/{inputId}:
    get:
      operationId: returnScanResult
      parameters:
      - in: path
        name: inputId
        required: true
        schema:
          type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TwistlockScanResultResponse'
          description: Success
        '422':
          description: Request arguments validation error
      security:
      - CustomAuthorizer: []
      summary: Return the scan results for the input scan-id if exist. otherwise,
        return NotFound Error
      tags:
      - Twistlock
      x-bc-docs-scope: standalone,prisma
      x-bc-lambda-name: bc-vulnerabilities-twistlock-api
      x-bc-permitted-roles: owner,admin,member,developer,auditor
  /code/api/v1/vulnerabilities/scan-results:
    post:
      operationId: saveScanResult
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TwistlockScanResultBody'
        required: true
      responses:
        '200':
          description: Success
        '422':
          description: Request arguments validation error
      security:
      - CustomAuthorizer: []
      summary: save exsiting the scan results in the cache
      tags:
      - Twistlock
      x-bc-docs-scope: standalone,prisma
      x-bc-lambda-name: bc-vulnerabilities-twistlock-api
      x-bc-permitted-roles: owner,admin,member,developer,auditor
  /code/api/v1/vulnerabilities/twistcli:
    get:
      description: Download twistcli binary by OS
      operationId: downloadTwistCli
      parameters:
      - in: query
        name: os
        required: true
        schema:
          $ref: '#/components/schemas/OS'
      responses:
        '302':
          description: Redirect
        '422':
          description: Request arguments validation error
      security:
      - CustomAuthorizer: []
      summary: Download twistcli
      tags:
      - Twistlock
      x-bc-docs-scope: standalone,prisma
      x-bc-lambda-name: bc-vulnerabilities-twistlock-api
      x-bc-permitted-roles: owner,admin,member,developer,auditor
  /code/api/v1/vulnerabilities/evaluate-cves:
    post:
      description: evaluate cves from packages (if has)
      operationId: evaluateCves
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TwistlockEvaluateCvesBody'
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/ReportCVE'
                type: array
          description: CVEs found on the packages passed as input
        '422':
          description: Request arguments validation error
      security:
      - CustomAuthorizer: []
      summary: evaluate cves from packages
      tags:
      - Twistlock
      x-bc-docs-scope: standalone,prisma
      x-bc-lambda-name: bc-vulnerabilities-twistlock-api
      x-bc-permitted-roles: owner,admin,member
servers:
- url: https://api.prismacloud.io
tags:
- description: The Twistlock endpoints are listed below.
  name: Twistlock
